<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

	<!-- 
		set our ProgrammFilesFolder depending on x64 or x86 build
 		http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg01750.html
 		http://n2.nabble.com/using-a-variable-for-Component-Win64-attribute-value-still-generating-generic-warning-not-uniquely-sd-td1515820.html
	!-->			
	<?if $(var.Platform) = "x64" ?>
	<?define ProgramFilesFolderHelper="ProgramFiles64Folder"?>
	<?else?>
	<?define ProgramFilesFolderHelper="ProgramFilesFolder"?>
	<?endif?>	
	
	<Fragment>
		<DirectoryRef Id="TARGETDIR">
			<Directory Id="$(var.ProgramFilesFolderHelper)" Name="PFiles">
				<Directory Id="InventorAddins" Name="Inventor-Addins">
					<Directory Id="INSTALLDIR" Name="PrintButtons">
						<Component Guid="00C63DCF-77D7-482A-A008-16802A4ED222" Id="InventorPrinterConfigXml" DiskId="1">
							<File Source="bin\InventorPrinterConfig.xml" Name="InventorPrinterConfig.xml" Id="InventorPrinterConfig.xml" KeyPath="yes" />
						</Component>
						<Component Guid="01F5D59A-946D-40CE-83F7-7236F449307B" Id="PrintButtonsDll" DiskId="1">
							<File Source="bin\PrintButtons.dll" Name="PrintButtons.dll" Id="PrintButtons.dll" KeyPath="yes" />
							<!-- generated by heat.exe on printbutton.dll; replaced file id [#PrintButtons.dll] -->
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value="" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32\1.0.0.17" Name="Class" Value="PrintButtons.InventorPlotClass+sRotatePlot" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32\1.0.0.17" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32\1.0.0.17" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32\1.0.0.17" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32" Name="Class" Value="PrintButtons.InventorPlotClass+sRotatePlot" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{74607E91-23C7-3472-814A-0C722CA5EC52}\InprocServer32" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value="" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32\1.0.0.17" Name="Class" Value="PrintButtons.XMLButtonDef+SingleButtonDefintion" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32\1.0.0.17" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32\1.0.0.17" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32\1.0.0.17" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32" Name="Class" Value="PrintButtons.XMLButtonDef+SingleButtonDefintion" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E81CFA62-537D-3E59-ADDA-F0E007C7F532}\InprocServer32" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\Description" Value="PrintButtons" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\Implemented Categories\{39AD2B5C-7A29-11D6-8E0A-0010B541CAA8}" Value="" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value="" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32\1.0.0.17" Name="Class" Value="PrintButtons.PrintButtons.StandardAddInServer" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32\1.0.0.17" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32\1.0.0.17" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32\1.0.0.17" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32" Name="Class" Value="PrintButtons.PrintButtons.StandardAddInServer" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\InprocServer32" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\Settings" Name="AddInType" Value="Standard" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\Settings" Name="LoadOnStartUp" Value="1" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\Settings" Name="SupportedSoftwareVersionGreaterThan" Value="13.." Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="CLSID\{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}\Settings" Name="Version" Value="0" Type="integer" Action="write" />
			                <RegistryValue Root="HKCR" Key="Component Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Name="0" Value=".NET Category" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{1279AEC8-5BCD-3E5E-A020-394479F1471D}\1.0.0.17" Name="Class" Value="PrintButtons.InventorPlotClass+strings" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{1279AEC8-5BCD-3E5E-A020-394479F1471D}\1.0.0.17" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{1279AEC8-5BCD-3E5E-A020-394479F1471D}\1.0.0.17" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{1279AEC8-5BCD-3E5E-A020-394479F1471D}\1.0.0.17" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{B522EFB1-3480-3794-82C6-DB8B1FB4687B}\1.0.0.17" Name="Class" Value="PrintButtons.PrintButtons.StandardAddInServer+TranslatorAddinEnum" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{B522EFB1-3480-3794-82C6-DB8B1FB4687B}\1.0.0.17" Name="Assembly" Value="PrintButtons, Version=1.0.0.17, Culture=neutral, PublicKeyToken=565c0741a0ba8e39" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{B522EFB1-3480-3794-82C6-DB8B1FB4687B}\1.0.0.17" Name="RuntimeVersion" Value="v2.0.50727" Type="string" Action="write" />
			                <RegistryValue Root="HKCR" Key="Record\{B522EFB1-3480-3794-82C6-DB8B1FB4687B}\1.0.0.17" Name="CodeBase" Value="file:///[#PrintButtons.dll]" Type="string" Action="write" />
						</Component>
						<Component Guid="2F98C0B2-10FC-4FD7-B635-04665F178BF0" Id="PrintButtonsTlb" DiskId="1">
							<File Source="bin\PrintButtons.tlb" Name="PrintButtons.tlb" Id="PrintButtons.tlb" KeyPath="yes" />
						</Component>
						<Component Guid="F8F2C2F6-53E5-4AFB-B0AB-84C68DF21C56" Id="SettingsXml" DiskId="1">
							<File Source="bin\settings.xml" Name="settings.xml" Id="settings.xml" KeyPath="yes" />
						</Component>
						<Directory Id="icos" Name="icos">
							<Component Guid="E72BD89D-21FD-469B-AF00-5EA83EDE46B0" Id="A3farbeGif" DiskId="1">
								<File Source="bin\icos\a3farbe.gif" Name="a3farbe.gif" Id="a3farbe.gif" KeyPath="yes" />
							</Component>
							<Component Guid="238FF6FA-701A-4776-B91A-EF9AF5D16EBE" Id="DefaultprinterGif" DiskId="1">
								<File Source="bin\icos\defaultprinter.gif" Name="defaultprinter.gif" Id="defaultprinter.gif" KeyPath="yes" />
							</Component>
							<Component Guid="1C4AC5FF-EA02-40FE-BB10-C5B37F3412F4" Id="FarbeGif" DiskId="1">
								<File Source="bin\icos\Farbe.gif" Name="Farbe.gif" Id="Farbe.gif" KeyPath="yes" />
							</Component>
							<Component Guid="85D6EA14-E9F4-4712-A529-1D92E3AAA5DD" Id="Farbe2Gif" DiskId="1">
								<File Source="bin\icos\Farbe2.gif" Name="Farbe2.gif" Id="Farbe2.gif" KeyPath="yes" />
							</Component>
							<Component Guid="6E43D0F0-FD15-49E1-B4A4-99A5717ED37F" Id="PdfGif" DiskId="1">
								<File Source="bin\icos\pdf.gif" Name="pdf.gif" Id="pdf.gif" KeyPath="yes" />
							</Component>
							<Component Guid="8D195754-4086-4337-8805-C996AE0E2A6F" Id="PdffarbeGif" DiskId="1">
								<File Source="bin\icos\pdffarbe.gif" Name="pdffarbe.gif" Id="pdffarbe.gif" KeyPath="yes" />
							</Component>
							<Component Guid="48686FC1-E7C8-4551-8634-43FE202CD92C" Id="RoweGif" DiskId="1">
								<File Source="bin\icos\rowe.gif" Name="rowe.gif" Id="rowe.gif" KeyPath="yes" />
							</Component>
							<Component Guid="676A1872-8CC1-4362-973C-8B841D87CC9F" Id="RoweheftGif" DiskId="1">
								<File Source="bin\icos\roweheft.gif" Name="roweheft.gif" Id="roweheft.gif" KeyPath="yes" />
							</Component>
						</Directory>
						<Directory Id="install" Name="install">
							<Component Guid="B1CA2D78-E471-4406-BB40-A1338E6379DC" Id="InstallBat" DiskId="1">
								<File Source="bin\install\install.bat" Name="install.bat" Id="install.bat" KeyPath="yes" />
							</Component>
							<Component Guid="CB47CDB5-A1DA-42A2-8827-6BAE9D81AE33" Id="UninstallBat" DiskId="1">
								<File Source="bin\install\uninstall.bat" Name="uninstall.bat" Id="uninstall.bat" KeyPath="yes" />
							</Component>
						</Directory>
						<Directory Id="languages" Name="languages">
							<Component Guid="246AD8C7-3459-408E-9F1B-4303B758424D" Id="DeuXml" DiskId="1">
								<File Source="bin\languages\deu.xml" Name="deu.xml" Id="deu.xml" KeyPath="yes" />
							</Component>
						</Directory>
					</Directory>
				</Directory>
			</Directory>
		</DirectoryRef>
		<DirectoryRef Id="TARGETDIR">
            <Component Id="cmpFC41C28EC1A5DDF1B38CB48A5F78258C" Guid="a0a5ddc8-e4e9-442d-8868-49a184b7b2a0">
                <Class Id="{74607E91-23C7-3472-814A-0C722CA5EC52}" Context="InprocServer32" Description="PrintButtons.InventorPlotClass+sRotatePlot" ThreadingModel="both" ForeignServer="mscoree.dll">
                    <ProgId Id="PrintButtons.InventorPlotClass+sRotatePlot" Description="PrintButtons.InventorPlotClass+sRotatePlot" />
                </Class>
                <Class Id="{E81CFA62-537D-3E59-ADDA-F0E007C7F532}" Context="InprocServer32" Description="PrintButtons.XMLButtonDef+SingleButtonDefintion" ThreadingModel="both" ForeignServer="mscoree.dll">
                    <ProgId Id="PrintButtons.XMLButtonDef+SingleButtonDefintion" Description="PrintButtons.XMLButtonDef+SingleButtonDefintion" />
                </Class>
                <Class Id="{E8B2615B-11AA-4B1B-9D7C-654026C99FAC}" Context="InprocServer32" Description="PrintButtons" ThreadingModel="both" ForeignServer="mscoree.dll">
                    <ProgId Id="PrintButtons.StandardAddInServer" Description="PrintButtons.PrintButtons.StandardAddInServer" />
                </Class>
            </Component>	
		</DirectoryRef>
	</Fragment>
</Wix>
